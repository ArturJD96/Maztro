{% from 'reusables.html' import searchForm %}
{% from 'reusables.html' import nav %}
{% from 'reusables.html' import results %}

<html>
<head>
    <title>An example</title>
    <script src="https://plugin.humdrum.org/scripts/humdrum-notation-plugin-worker.js"></script>
    <link href="{{ url_for('static', filename='results.css') }}" rel="stylesheet" type="text/css" />
    <link href="{{ url_for('static', filename='google.css') }}" rel="stylesheet" type="text/css" />
    <style>
        #title {
            text-align: center;
        }
        #result-stats {
            color: #70757a;
            margin-bottom:50px;
        }
        .filename {
            margin-left: 0vw;
        }
    </style>
</head>
<body>
    {{ nav() }}
    <div class="col1">
        <!-- the following content is generated using searchForm() from resuables.html-->
        {{ searchForm()}}
        <!-- end content -->
    </div>
    <div class="col2">
        <div id="result-stats">
            {% if numresults is defined %}
            {{ numresults }} results found in {{ time }} seconds
            {% else %}
            searching database...
            {% endif %}
        </div>
        <script>
            {% for sonata, filter in test.items(): %}
                {% for measure_range in filter|list: %}
                    displayHumdrum({
                        //uri: "github://craigsapp/mozart-piano-sonatas/kern/{{sonata}}",
                        url: "{{ url_for('static', filename='kern/') }}{{sonata}}",
                        //uri: "github://craigsapp/hummel-preludes/kern/prelude67-15.krn",
                        source: '{{ sonata|replace('.', '') }}{{measure_range}}',
                        //source: 'sonata03-1',
                        pageMarginBottom: 150,
                        pageMarginTop: 10,
                        pageWidth: 750,
                        spacingStaff: 14,
                        spacingSystem: 0,
                        scale: 50,
                        filter: "myank -m {{ measure_range }}",
                        bottomMarginHeader: 0,
                    });
                {% endfor %}
            {% endfor %}

        </script>

        {% for sonata, filter in test.items(): %}
        {% for measure_range in filter|list: %}
        <br />
        <span class="filename" style="font-size:12px">bass similarity score: <b>{{ correlations[sonata][loop.index0] * 100}} % </b> </span>
        <br />
        <a href="http://verovio.humdrum.org/?file=mozart/sonatas/{{sonata}}&filter=myank -m {{ measure_range }}" class="sonata" target="_blank">
            <span class="filename">Piano Sonata No. {{sonata[6:-4]}} >> bar {{measure_range}}</span>
            <br />
            <span class="filename" style="color:black; font-size:14px"> Wolfgang Amadeus Mozart </span>
        </a>
        <script type="text/x-humdrum" id="{{ sonata|replace('.', '') }}{{measure_range}}"></script>
        {% endfor %}
        {% endfor %}
        </script>
    </div>

</body>
</html>